# huffman压缩

文件压缩是什么：

> 文件压缩是不丢失有用信息的前提下，缩减数据量以减少存储空间，提高其传输、储存和处理效率，或按照一定的算法对文件中数据进行组织，减少数据的冗余和存储的空间的一种技术方法。

为什么压缩：

> 1. 紧缩数据存储容量，减少存储空间。
> 2. 可以提高数据传输的速度，减少带宽占用量，提高通讯效率
> 3. 对数据的一种加密保护，增强数据在传输过程中的安全性。

压缩的分类：

> - 有损压缩
>
>   有损压缩是允许压缩过程中损失一定的信息，虽然解压缩的时候不能完全恢复原始数据，但是所损失的部分对理解原始图像的影响比较小，却换来了大的多的压缩比。即指使用压缩后的数据进行重构，冲欧后的数据与原来的数据有所不同，但不影响人对原始资料表达的信息造成误解。
>
> - 无损压缩
>
>   对文件中数据按照特定的编码格式进行重新组织，压缩后的压缩文件可以被还原成于源文件完全相同的格式，不会影响文件内容，对于数码图像而言，不会使图像细节有任何损失。

> **lz77**的原理：将重复出现的内容采用更短的长度距离对来进行替换
>
> 在文件中的局部范围内，有些语句可能会重复出现，对于重复出现得于能否想办法让其变短，如果可以，能够起到压缩的目的。如：
>
> ```ASN.1
> abcdef123abcd456abcdef789
> ```
>
> 对于文件中重复出现的词语，可以使用<长度, 距离>对其进行替换，长度是重复文件所占的字节。距离是后文中重复出现词语的首字节与钱文中重复的词语的首字节的位置差。如果有出现多次的，看是否有重复度更高的，没有再取最近的。
>
> ```asp
> abcd123<4,7>456<6,16>789
> ```

但是如果是没有较长语句的重复，只是在字节层面上有些重复。一个字节占八个比特位，如果能够给每个字节找一个小于8bit位的编码，来替换文件中的字节，比如：

> - 定长编码：如果对四个字符ABCD进行编码，只需要用两个bit位
>
>   A: 00 B: 01 C: 10 D: 11
>
>   用找到的编码对文件中的每个字节来进行替换：11110001就代表ddac，11110110就代表着ddbc。
>
>   但是字节重复出现的次数不一样，能否让出现次数多的字节对应的编码位数少一些，这样就会让占用的空间少一些。
>
> - 动态不等长编码：A： 100 B 101 C 11 D 0
>
>   要求：一个编码不能是另外编码的前缀。否则解码会错误。
>
>   用huffman树，所有字符对应编码都在叶子节点的位置，因此不可能出现某个字符编码是其他字符编码前缀的情况，
>
> 这是**基于huffman树编码的压缩**

GZIP的第一步时使用LZ77快速的对文件中的重复的短语进行压缩，随后进行huffman树压缩。

> huffman树
>
> 从二叉树的根节点到二叉树中所有叶子节点的路径长度（边的个数）与相应权值的乘积之和为该二叉树的带权路径长度WPL。
>
> 叶子节点的权值不同，带权路径长度不同。
>
> **huffman树就是带权路径最小的二叉树。**
>
> 我们需要让权值大的靠近根。

huffman树的构建：

1. 由给定的n个权值[w1, w2, w2...., wn]构造n个节点，叫二叉树森林。
2. 取出两个最小的权值节点，分别作为新节点的左右子树，然后把构造的新节点加到森林中。
3. 最终森林中只有一棵树时，结束。

huffman编码压缩过程：

1. 统计源文件中每个字节出现的次数并记录
2. 用字节的频次来创建huffman树
3. 获取每个字节的huffman编码
4. 用得到的编码对源文件中的每个字节进行改写。
